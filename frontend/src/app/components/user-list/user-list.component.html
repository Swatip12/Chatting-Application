<div class="user-list-container">
  <!-- Header -->
  <div class="user-list-header">
    <div class="d-flex justify-content-between align-items-center">
      <h5 class="mb-0">Users</h5>
      <div class="user-count-badge">
        <span class="badge bg-primary">{{ getOnlineUsersCount() }}/{{ getTotalUsersCount() }}</span>
      </div>
    </div>
    
    <!-- Connection Status -->
    <div class="connection-status mt-2">
      <div class="d-flex align-items-center">
        <i [class]="connectionStatus ? 'fas fa-wifi text-success' : 'fas fa-wifi-slash text-danger'"></i>
        <small class="ms-2" [class]="connectionStatus ? 'text-success' : 'text-danger'">
          {{ connectionStatus ? 'Connected' : 'Disconnected' }}
        </small>
        <button 
          *ngIf="!connectionStatus" 
          class="btn btn-sm btn-outline-primary ms-auto"
          (click)="refreshUsers()"
          title="Refresh users">
          <i class="fas fa-sync-alt"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- User List Content -->
  <div class="user-list-content">
    <!-- Online Users Section -->
    <div *ngIf="users.filter(user => isOnline(user)).length > 0" class="user-section">
      <div class="section-header">
        <small class="text-muted text-uppercase fw-bold">
          <i class="fas fa-circle text-success me-1"></i>
          Online ({{ getOnlineUsersCount() }})
        </small>
      </div>
      
      <div 
        *ngFor="let user of users | slice:0:50; trackBy: trackByUserId" 
        class="user-item"
        [class.active]="isSelected(user)"
        [class.online]="isOnline(user)"
        (click)="selectUser(user)"
        *ngIf="isOnline(user)">
        
        <div class="d-flex align-items-center">
          <!-- User Avatar -->
          <div class="user-avatar me-3">
            <div class="avatar-circle" [class.online]="isOnline(user)">
              {{ getUserInitial(user.username) }}
              <div class="status-indicator" [class.online]="isOnline(user)"></div>
            </div>
          </div>
          
          <!-- User Info -->
          <div class="user-info flex-grow-1">
            <div class="user-name">{{ user.username }}</div>
            <div class="user-status" [ngClass]="getStatusClass(user)">
              <i [class]="getStatusIcon(user)" class="me-1"></i>
              {{ getLastSeenText(user) }}
            </div>
          </div>
          
          <!-- Selection Indicator -->
          <div *ngIf="isSelected(user)" class="selection-indicator">
            <i class="fas fa-check-circle text-primary"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Offline Users Section -->
    <div *ngIf="users.filter(user => !isOnline(user)).length > 0" class="user-section">
      <div class="section-header">
        <small class="text-muted text-uppercase fw-bold">
          <i class="far fa-circle text-muted me-1"></i>
          Offline ({{ users.length - getOnlineUsersCount() }})
        </small>
      </div>
      
      <div 
        *ngFor="let user of users | slice:0:50; trackBy: trackByUserId" 
        class="user-item"
        [class.active]="isSelected(user)"
        [class.offline]="!isOnline(user)"
        (click)="selectUser(user)"
        *ngIf="!isOnline(user)">
        
        <div class="d-flex align-items-center">
          <!-- User Avatar -->
          <div class="user-avatar me-3">
            <div class="avatar-circle offline">
              {{ getUserInitial(user.username) }}
              <div class="status-indicator offline"></div>
            </div>
          </div>
          
          <!-- User Info -->
          <div class="user-info flex-grow-1">
            <div class="user-name">{{ user.username }}</div>
            <div class="user-status" [ngClass]="getStatusClass(user)">
              <i [class]="getStatusIcon(user)" class="me-1"></i>
              {{ getLastSeenText(user) }}
            </div>
          </div>
          
          <!-- Selection Indicator -->
          <div *ngIf="isSelected(user)" class="selection-indicator">
            <i class="fas fa-check-circle text-primary"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="users.length === 0" class="empty-state">
      <div class="text-center py-4">
        <i class="fas fa-users fa-2x text-muted mb-3"></i>
        <p class="text-muted mb-0">No users available</p>
        <button class="btn btn-sm btn-outline-primary mt-2" (click)="refreshUsers()">
          <i class="fas fa-sync-alt me-1"></i>
          Refresh
        </button>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="users.length === 0 && connectionStatus" class="loading-state">
      <div class="text-center py-4">
        <div class="spinner-border spinner-border-sm text-primary mb-2" role="status">
          <span class="visually-hidden">Loading users...</span>
        </div>
        <p class="text-muted mb-0">Loading users...</p>
      </div>
    </div>
  </div>
</div>